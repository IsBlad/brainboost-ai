{% extends "layout.html" %}

{% block title %}Brainboost AI - My Lists{% endblock %}

{% block content %}
<div class="lists-container">
    <h1>My Vocabulary Lists</h1>
    <div class="card-container">
        {% for list_name, count in wordlists_and_counts.items() %}
        <div class="card" id="card-{{ list_name }}">
            <!-- Trashcan icon as an inline SVG -->
            <span class="close" onclick="deleteCard('{{ list_name }}')">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#EDE3DE" viewBox="0 0 24 24">
                    <path d="M3 6h18v2H3V6zm2 4h14v12H5V10zm5 2v8H8v-8h2zm4 0v8h-2v-8h2zm4 0v8h-2v-8h2zm-7-8V2h4v2h5v2H5V4h5z"/>
                </svg>
            </span>
            <h2>{{ list_name }}</h2>
            <p>{{ count }} words</p>
            <div class="card-buttons">
                <button class="btn edit-button" onclick="editList('{{ list_name }}')">Edit</button>
                <button class="btn games-button" onclick="window.location.href='{{ url_for('qr_code', activity='wordsup', list=list_name) }}'">
                    Games
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/lists.js') }}"></script>
<script>
function editList(listName) {
    window.location.href = `/reviewdefinitions?list=${encodeURIComponent(listName)}`;
}

// Function to delete a vocabulary list
function deleteCard(listName) {
    // Confirm deletion with the user
    if (confirm(`Are you sure you want to delete the list "${listName}"?`)) {
        fetch(`/delete_list/${listName}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                // Remove the card element from the DOM if successful
                const card = document.getElementById(`card-${listName}`);
                if (card) {
                    card.remove();
                }
                alert(`List "${listName}" has been deleted.`);
            } else {
                // Show an error message if deletion failed
                alert("Failed to delete the list. Please try again.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("An error occurred. Please try again.");
        });
    }
}
</script>
{% endblock %}